

<table class="table table-condensed" id="table">
</table>
<br />

<label style="font-weight:lighter" for="stars">Odaberite ocjenu:</label>
@{ 
    Html.BeginForm("AddReview", "Home", FormMethod.Post, new { @id = "reviewForm" });
                   }
        <select id="stars">


            <option value="5">5</option>
        
            <option value="4">4</option>


            <option value="3">3</option>
        
            <option value="2">2</option>


            <option value="1">1</option>
        </select>
        <br />
        <br />
        <input type="text" id="details" placeholder="Upišite svoje mišljenje..." />
        <br />
        <br />
        <button class="btn-default" type="submit">Pošalji</button>
<br />
<br />
        


<script src="~/Scripts/jquery-3.4.1.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script>
     @{ var user = HttpContext.Current.User.Identity;

            var claimsIdentity = (System.Security.Claims.ClaimsIdentity)this.User.Identity;
            var claim = claimsIdentity.FindFirst(System.Security.Claims.ClaimTypes.NameIdentifier);
            string userId = "1";
            if (claim != null)
            {
                userId = claim.Value;
            }

}

    $("#reviewForm").submit(function (e) {
                    e.preventDefault();

                    var $form = $(this);
        var url = $form.attr("action");
        var stars = document.getElementById("stars");

        if ($("#details").val() == "") {
            var review = {
            ApartmentId: @ViewData["id"],
            UserId: @userId,
            Details: " ",
            Stars: stars.value


            }
        } else {
            var review = {
            ApartmentId: @ViewData["id"],
            UserId: @userId,
                Details: $("#details").val(),
            Stars: stars.value


            }
        }




                console.log(review);
            $.ajax({
                type: "post",
                url: url,
                datatype: "json",
                data: review,
                success: function (response) {
                        //JS sort array and DOM manipulation

                        alert(response);



                    }
                });
            });

    $(document).ready(function () {



    $.ajax({
        url: "/Home/GetReviews",
        type: "POST",
        data: { 'ApartmentId': @ViewData["id"] },
        success: function (result) {

            console.log(result);
            var table = document.getElementById("table");

            for (var i = 0; i < 5; i++) {

                table.insertAdjacentHTML("beforeend", "<tr class='warning'><th>Anonymous user</th></tr><tr><td>(" + result[i].Stars + " stars) " + result[i].Details + "</td></tr>");

            }
        }
    });
    });




</script>

